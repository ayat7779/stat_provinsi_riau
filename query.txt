      
            SELECT kc.id_kode_level, tahun_lkpd, kode, uraian, anggaran, realisasi, (realisasi/anggaran)*100 AS persentase FROM (
            SELECT tahun_lkpd, LEFT(kode_catatan,2) AS kode, SUM(jumlah_anggaran) AS anggaran, SUM(jumlah_realisasi) AS realisasi FROM lkpd_apbd_lampiran_1 la INNER JOIN kode_catatan kc ON la.`id_kode_catatan`=kc.`id`
            GROUP BY tahun_lkpd, kode
            UNION ALL
            SELECT tahun_lkpd, LEFT(kode_catatan,4) AS kode, SUM(jumlah_anggaran) AS anggaran, SUM(jumlah_realisasi) AS realisasi  FROM lkpd_apbd_lampiran_1 la INNER JOIN kode_catatan kc ON la.`id_kode_catatan`=kc.`id`
            GROUP BY tahun_lkpd, kode 
            UNION ALL
            SELECT tahun_lkpd, kode_catatan AS kode, SUM(jumlah_anggaran) AS anggaran, SUM(jumlah_realisasi) AS realisasi  FROM lkpd_apbd_lampiran_1 la INNER JOIN kode_catatan kc ON la.`id_kode_catatan`=kc.`id`
            GROUP BY tahun_lkpd, kode
            ) AS a
            INNER JOIN kode_catatan AS kc ON a.kode = kc.`kode_catatan`
            ORDER BY tahun_lkpd, kode